<h1><%= @project.name %> : Manage Members</h1>

<ol class="breadcrumb">
  <li><a><%= link_to "Projects", projects_path %> </a></li>
  <li><a> <%= link_to @project.name, project_path(@project) %></a></li>
  <li class= "active">Memberships</li>
</ol>

  <div>
    <%= render 'membererrorform/membererror', model: @membership %>
  </div>

  <%= form_for([@project,@membership], html: {class: "form-horizonal"}) do |f| %>

      <div class="well form-inline col-md-5">
        <%= f.label :user_id %>
        <%= f.collection_select :user_id, User.all, :id, :full_name,
          {include_blank: "Please select.."},
          {class: "dropdown-toggle form-control"} %>
        <%= f.select(:role, ["Member", "Owner"], {}, {class: "form-control"}) %>
        <%= f.submit "Add new member", class: "btn btn-primary" %>
      </div>
  <% end %>

<div class="col col-sm-8">
  <table class="table">
    <thead>
        <tr>
            <th>

            </th>
            <th>

            </th>
            <th>

            </th>
            <th>

            </th>
        </tr>
    </thead>
    <tbody>
      <% @project.users.order(:first_name).each do |user| %>
        <% user.memberships.where(project_id: @project).each do |membership| %>
            <%= form_for([@project,membership]) do |f| %>
              <tr>
                <td>
              <%= link_to user.full_name,
              user_path(user) %>
                </td>
              <td>
              <%= f.select(:role, ["Owner","Member"]) %>
              </td>
              <td>
              <%= f.submit class: "btn btn-primary" %>
              </td>
              <td>
              <%= link_to "", project_membership_path(
              @project,membership
              ),
              method: :delete, data: {
              confirm: "Are you sure you want to delete this user?"
              }, class: "glyphicon glyphicon-remove" %>
              </td>
            </tr>
            <% end %>
        <% end %>
      <% end %>
    </tbody>
  </table>
</div>
