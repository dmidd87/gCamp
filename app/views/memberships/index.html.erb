<div class="container">

<div class="page-header">
  <span class="h1"><%= @project.name %>: Manage Memberships</span>
</div>
<ol class="breadcrumb">
  <li><%= link_to "Projects", projects_path %></li>
  <li><%= link_to @project.name, project_path(@project) %></li>
  <li class="active">Memberships</li>
</ol>

<div class="pull-left">
  <%= render 'errorform/errorform', model: @membership %>
</div>

  <%= form_for([@project, @membership], html: {class: "form-horizonal"}) do |f| %>

      <div class="well form-inline col-md-5">
        <%= f.label :user_id %>
        <%= f.collection_select :user_id, User.all, :id, :full_name,
          {include_blank: "Please select.."},
          {class: "dropdown-toggle form-control"} %>
        <%= f.select(:role, ["Owner", "Member"], {}, {class: "form-control"}) %>
        <%= f.submit "Add new member", class: "btn btn-primary" %>
      </div>
  <% end %>

  <table>
    <tbody>
      <% @project.users.order(:first_name).each do |user| %>
        <% user.memberships.where(project_id: @project).each do |membership| %>
          <tr>
            <%= form_for([@project,membership]) do |f| %>
            <td class="col-sm-2">
              <%= link_to user.full_name,
              user_path(user) %>  </td>
            <td class="col-sm-1">
              <%= f.select(:role, ["Owner","Member"]) %>
            </td>
            <td>
              <%= f.submit class: "btn btn-primary" %>
            </td>
            <td>
              <%= link_to "", project_membership_path(
              @project,membership
              ),
              method: :delete, data: {
              confirm: "Are you sure you want to delete this user?"
              }, class: "glyphicon glyphicon-remove" %>
              <br>
            </td>
            <% end %>
          </tr>
        <% end %>
      <% end %>
        </tr>
    </tbody>
  </table>
</div>
